{"version":3,"file":"validator.js","sources":["../../src/validator.js"],"sourcesContent":["import * as R from 'ramda'\nimport { validate as validateSpec } from 'spected'\nimport { isNilOrEmpty, isNotNilOrEmpty } from './ramda-extra'\n\nconst renderMsg = (tmpl, arg) => (R.is(Function, tmpl) ? tmpl(arg) : tmpl)\n\nconst rules = {\n  match: (pattern, msg = `should match: ${pattern}`) => [\n    R.test(pattern),\n    renderMsg(msg, pattern),\n  ],\n\n  minLength: (length, msg = `should have min length: ${length}`) => [\n    R.pipe(R.length, R.gte(R.__, length)),\n    renderMsg(msg, length),\n  ],\n\n  notBlank: (msg = 'should not be blank') => [isNotNilOrEmpty, msg],\n}\n\nconst hasNoErrors = results => {\n  const shouldExclude = R.cond([\n    [isNilOrEmpty, R.T],\n    [R.is(Object), hasNoErrors],\n  ])\n  return R.pipe(R.reject(shouldExclude), R.isEmpty)(results)\n}\n\nconst defineValidator = ({ spec }) => {\n  const validate = validateSpec(R.always(null), R.identity, spec)\n\n  return {\n    allValid: R.pipe(validate, hasNoErrors),\n    checkField: (path, input) => R.pipe(validate, R.path(path))(input),\n    checkAll: validate,\n  }\n}\n\nexport { defineValidator, rules }\n"],"names":["renderMsg","tmpl","arg","R","Function","rules","pattern","msg","length","isNotNilOrEmpty","hasNoErrors","shouldExclude","isNilOrEmpty","Object","results","defineValidator","spec","validate","validateSpec","path","input"],"mappings":";;;;AAIA,IAAMA,YAAY,SAAZA,SAAY,CAACC,IAAD,EAAOC,GAAP;SAAgBC,EAAA,CAAKC,QAAL,EAAeH,IAAf,IAAuBA,KAAKC,GAAL,CAAvB,GAAmCD,IAAnD;CAAlB;;AAEA,IAAMI,QAAQ;SACL,eAACC,OAAD;QAAUC,GAAV,0FAAiCD,OAAjC;WAA+C,CACpDH,IAAA,CAAOG,OAAP,CADoD,EAEpDN,UAAUO,GAAV,EAAeD,OAAf,CAFoD,CAA/C;GADK;;aAMD,mBAACE,SAAD;QAASD,GAAT,oGAA0CC,SAA1C;WAAuD,CAChEL,IAAA,CAAOA,MAAP,EAAiBA,GAAA,CAAMA,EAAN,EAAYK,SAAZ,CAAjB,CADgE,EAEhER,UAAUO,GAAV,EAAeC,SAAf,CAFgE,CAAvD;GANC;;YAWF;QAACD,GAAD,uEAAO,qBAAP;WAAiC,CAACE,eAAD,EAAkBF,GAAlB,CAAjC;;CAXZ;;AAcA,IAAMG,cAAc,SAAdA,WAAc,UAAW;MACvBC,gBAAgBR,IAAA,CAAO,CAC3B,CAACS,YAAD,EAAeT,CAAf,CAD2B,EAE3B,CAACA,EAAA,CAAKU,MAAL,CAAD,EAAeH,WAAf,CAF2B,CAAP,CAAtB;SAIOP,IAAA,CAAOA,MAAA,CAASQ,aAAT,CAAP,EAAgCR,OAAhC,EAA2CW,OAA3C,CAAP;CALF;;AAQA,IAAMC,kBAAkB,SAAlBA,eAAkB,OAAc;MAAXC,IAAW,QAAXA,IAAW;;MAC9BC,cAAWC,SAAaf,MAAA,CAAS,IAAT,CAAb,EAA6BA,QAA7B,EAAyCa,IAAzC,CAAjB;;SAEO;cACKb,IAAA,CAAOc,WAAP,EAAiBP,WAAjB,CADL;gBAEO,oBAACS,OAAD,EAAOC,KAAP;aAAiBjB,IAAA,CAAOc,WAAP,EAAiBd,IAAA,CAAOgB,OAAP,CAAjB,EAA+BC,KAA/B,CAAjB;KAFP;cAGKH;GAHZ;CAHF;;;;"}